<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mentorium ‚Äî –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>

  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

  <!-- Telegram -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- Google API (onload -> handleClientLoad –∏–∑ services/googleCalendar.js) -->
  <script src="https://apis.google.com/js/api.js" async defer onload="handleClientLoad()"></script>

  <!-- Jitsi -->
  <script src="https://meet.jit.si/external_api.js"></script>

  <!-- Runtime secrets (not committed) -->
  <script src="env.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="topbar">
    <div class="topbar-content">
      <div>
        <div class="eyebrow">Mentorium</div>
        <div class="hello">–ü—Ä–∏–≤–µ—Ç, <span id="student-name">–°—Ç—É–¥–µ–Ω—Ç</span></div>
        <div class="muted small">
          ID: <span id="student-id">‚Äî</span>
          <span id="student-role" class="pill pill-supabase" style="display:none;"></span>
          <button id="profile-sync-btn" class="btn tiny ghost" style="display:none;">–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
        </div>
      </div>
      <div class="status-chips">
        <div class="chip status-chip status-idle" data-status-id="supabase"><span class="label">Supabase</span><span class="status-text">‚Äî</span></div>
        <div class="chip status-chip status-idle" data-status-id="google"><span class="label">Google</span><span class="status-text">‚Äî</span></div>
        <div class="chip status-chip status-idle" data-status-id="jitsi"><span class="label">Jitsi</span><span class="status-text">–ì–æ—Ç–æ–≤</span></div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- üî• –ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–±—ã—Ç–∏–µ -->
    <section id="tab-next" class="tab active">
      <div class="card highlight">
        <div class="card-header">
          <div class="card-title">üöÄ –ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–±—ã—Ç–∏–µ</div>
          <div class="muted small">–ò–∑ Google –∏–ª–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</div>
        </div>
        <div id="next-event-content">–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Google –∏–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
        <button id="google-auth-btn" class="btn ghost">–í–æ–π—Ç–∏ –≤ Google</button>
      </div>
    </section>

    <!-- üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
    <section id="tab-schedule" class="tab">
      <div class="card">
        <div class="card-title">üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>

        <div id="teacher-schedule-card" class="card subcard" style="display:none;">
          <div class="card-title">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ —É—á–µ–Ω–∏–∫—É</div>
          <div class="grid-2">
            <label class="field">
              <span class="muted small">ID —É—á–µ–Ω–∏–∫–∞</span>
              <input type="number" id="event-student-id" placeholder="Telegram ID —É—á–µ–Ω–∏–∫–∞">
            </label>
            <label class="field">
              <span class="muted small">–¢–µ–º–∞</span>
              <input type="text" id="event-subject" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞">
            </label>
            <label class="field">
              <span class="muted small">–î–∞—Ç–∞</span>
              <input type="date" id="event-date">
            </label>
            <label class="field">
              <span class="muted small">–í—Ä–µ–º—è</span>
              <input type="time" id="event-time">
            </label>
            <label class="field" style="grid-column:1/3;">
              <span class="muted small">–°—Å—ã–ª–∫–∞ –Ω–∞ –≤—Å—Ç—Ä–µ—á—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
              <input type="url" id="event-link" placeholder="https://meet...">
            </label>
          </div>
          <button class="btn full" id="event-submit-btn">–°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ</button>
        </div>

        <div id="calendar"></div>

        <div class="card" style="margin-top:1rem;">
          <div class="card-title">–°–æ–±—ã—Ç–∏—è –Ω–∞ –¥–∞—Ç—É</div>
          <ul id="event-list"><li>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</li></ul>
        </div>
      </div>
    </section>

    <!-- üìù –î–æ–º–∞—à–∫–∞ -->
    <section id="tab-homework" class="tab">
      <div class="card">
        <div class="card-title">üìù –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</div>
        <label class="field">
          <span class="muted small">–§–∞–π–ª</span>
          <input type="file" id="hw-file">
        </label>
        <button id="hw-upload-btn" class="btn full">–ó–∞–≥—Ä—É–∑–∏—Ç—å –î–ó</button>
        <div id="hw-status" class="muted" style="margin-top:.5rem;"></div>

        <h3 class="section-subtitle">–ú–æ–∏ —Ñ–∞–π–ª—ã</h3>
        <div id="hw-list">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
      </div>
    </section>

    <!-- üé• –í–∏–¥–µ–æ -->
    <section id="tab-video" class="tab">
      <div class="card">
        <div class="card-title">üé• –í–∏–¥–µ–æ–º–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
        <div class="field">
          <span class="muted small">–§–∞–π–ª</span>
          <input type="file" id="video-file" accept="video/*">
        </div>
        <div class="field">
          <span class="muted small">–ù–∞–∑–≤–∞–Ω–∏–µ</span>
          <input type="text" id="video-title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –õ–µ–∫—Ü–∏—è 3">
        </div>
        <button id="video-upload-btn" class="btn full">–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ</button>
        <div id="video-status" class="muted" style="margin-top:.5rem;"></div>

        <h3 class="section-subtitle">–°–ø–∏—Å–æ–∫ –≤–∏–¥–µ–æ</h3>
        <div id="video-list">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
      </div>
    </section>

    <!-- ü¶ö Jitsi -->
    <section id="tab-jitsi" class="tab">
      <div class="card">
        <div class="card-title">üíª –í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ Jitsi</div>
        <div id="jitsi-container" style="height:340px;"></div>
        <div class="button-row">
          <button class="btn" onclick="window.jitsiApi?.executeCommand('toggleAudio')">üéô</button>
          <button class="btn" onclick="window.jitsiApi?.executeCommand('toggleVideo')">üì∑</button>
          <button class="btn" onclick="window.jitsiApi?.executeCommand('toggleChat')">üí¨</button>
          <button class="btn" onclick="window.jitsiApi?.executeCommand('toggleShareScreen')">üñ•</button>
          <button class="btn" id="jitsi-participants-btn">üë•</button>
        </div>
      </div>
    </section>
  </main>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
  <nav class="tab-bar">
    <button id="btn-next" class="active">üî•<br>–°–æ–±—ã—Ç–∏–µ</button>
    <button id="btn-schedule">üìÖ<br>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
    <button id="btn-homework">üìù<br>–î–æ–º–∞—à–∫–∞</button>
    <button id="btn-video">üé•<br>–í–∏–¥–µ–æ</button>
    <button id="btn-jitsi">ü¶ö<br>Jitsi</button>
  </nav>

  <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ø–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω) -->
  <script type="module" src="js/utils/date.js"></script>
  <script type="module" src="js/utils/dom.js"></script>

  <script type="module" src="js/config.js"></script>

  <script type="module" src="js/services/supabase.js"></script>
  <script type="module" src="js/services/googleCalendar.js"></script>
  <script type="module" src="js/services/meetings.js"></script>

  <script type="module" src="js/ui/tabs.js"></script>
  <script type="module" src="js/ui/nextEventCard.js"></script>
  <script type="module" src="js/ui/calendarView.js"></script>
  <script type="module" src="js/ui/homeworkView.js"></script>
  <script type="module" src="js/ui/videoView.js"></script>
  <script type="module" src="js/ui/jitsiView.js"></script>
  <script type="module" src="js/ui/toast.js"></script>
  <script type="module" src="js/ui/status.js"></script>

  <script type="module" src="js/main.js?v=2025-08-24"></script>

  <div id="toast-container"></div>
</body>
</html>
