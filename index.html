<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mentorium ‚Äî –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>

  <!-- –°—Ç–∏–ª–∏ –∏ FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    body { margin:0; font-family:sans-serif; background:#121212; color:#fff; }
    header { background:#1f1f1f; padding:1rem; text-align:center; position:sticky; top:0; }
    #calendar { background:#fff; color:#000; border-radius:8px; min-height:300px; }
    .fc-daygrid-day-frame { cursor:pointer; }
    nav.tab-bar { position:fixed; bottom:0; left:0; right:0; display:flex; background:#1f1f1f; }
    nav.tab-bar button { flex:1; padding:.5rem 0; border:none; background:none; color:#aaa; }
    nav.tab-bar button.active { color:#fff; }
    .tab { display:none; padding:1rem; padding-bottom:4rem; }
    .tab.active { display:block; }
    .card { background:#1e1e1e; border-radius:8px; padding:1rem; margin-bottom:1rem; }
    .card-title { font-weight:bold; margin-bottom:.5rem; }
    button.upload, #authorize-button { background:#4285f4; color:#fff; border:none; padding:.5rem 1rem; border-radius:4px; cursor:pointer; }
  </style>

  <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <script src="https://apis.google.com/js/api.js" onload="handleClientLoad()"></script>
  <script src="https://meet.jit.si/external_api.js"></script>
</head>

<body>
  <header>
    –ü—Ä–∏–≤–µ—Ç, <span id="student-name">–°—Ç—É–¥–µ–Ω—Ç</span>
  </header>

  <main>
    <!-- üî• –ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–±—ã—Ç–∏–µ -->
    <section id="tab-next" class="tab active">
      <div class="card">
        <div class="card-title">üöÄ –ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–±—ã—Ç–∏–µ</div>
        <div id="next-event-content">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å</div>
        <button id="authorize-button">–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ Google Calendar</button>
      </div>
    </section>

    <!-- üìÖ Google Calendar -->
    <section id="tab-schedule" class="tab">
      <div class="card">
        <div class="card-title">üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
        <div id="calendar"></div>
        <div class="card" style="margin-top:1rem;">
          <div class="card-title">–°–æ–±—ã—Ç–∏—è –Ω–∞ –¥–∞—Ç—É</div>
          <ul id="event-list"><li>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</li></ul>
        </div>
      </div>
    </section>

    <!-- üìù –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è (Supabase) -->
    <section id="tab-homework" class="tab">
      <div class="card">
        <div class="card-title">üìù –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</div>
        <input type="file" id="hw-file">
        <button class="upload" onclick="uploadHomework()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –î–ó</button>
        <div id="hw-status" style="margin-top:.5rem;"></div>
        <h3 style="margin-top:1rem;">–ú–æ–∏ —Ñ–∞–π–ª—ã</h3>
        <div id="hw-list">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
      </div>
    </section>

    <!-- üé• –í–∏–¥–µ–æ–º–∞—Ç–µ—Ä–∏–∞–ª—ã (Supabase) -->
    <section id="tab-video" class="tab">
      <div class="card">
        <div class="card-title">üé• –í–∏–¥–µ–æ–º–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
        <input type="file" id="video-file" accept="video/*"><br><br>
        <input type="text" id="video-title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
        <button class="upload" onclick="uploadVideo()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ</button>
        <div id="video-status" style="margin-top:.5rem;"></div>
        <h3 style="margin-top:1rem;">–°–ø–∏—Å–æ–∫ –≤–∏–¥–µ–æ</h3>
        <div id="video-list">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
      </div>
    </section>

    <!-- ü¶ö Jitsi -->
    <section id="tab-jitsi" class="tab">
      <div class="card">
        <div class="card-title">üíª –í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ Jitsi</div>
        <div id="jitsi-container" style="height:300px;"></div>
        <div style="margin-top:1rem;display:flex;gap:.5rem;flex-wrap:wrap;">
          <button onclick="jitsiApi.executeCommand('toggleAudio')">üéô</button>
          <button onclick="jitsiApi.executeCommand('toggleVideo')">üì∑</button>
          <button onclick="jitsiApi.executeCommand('toggleChat')">üí¨</button>
          <button onclick="jitsiApi.executeCommand('toggleShareScreen')">üñ•</button>
          <button onclick="alertParticipants()">üë•</button>
        </div>
      </div>
    </section>
  </main>

  <nav class="tab-bar">
    <button id="btn-next"     class="active">üî•</button>
    <button id="btn-schedule">üìÖ</button>
    <button id="btn-homework">üìù</button>
    <button id="btn-video">üé•</button>
    <button id="btn-jitsi">ü¶ö</button>
  </nav>

  <!-- –ú–æ–¥—É–ª–∏ -->
  <script type="module" src="js/supabaseClient.js"></script>
  <script type="module" src="js/googleCalendar.js"></script>
  <script type="module" src="js/app.js"></script>
</body>
</html>