<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mentorium ‚Äî –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>

  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

  <!-- Telegram -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- Jitsi -->
  <script src="https://meet.jit.si/external_api.js"></script>

  <!-- Runtime secrets (not committed) -->
  <script src="env.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="topbar">
    <div class="topbar-content">
      <div>
        <div class="eyebrow">Mentorium</div>
        <div class="hello">–ü—Ä–∏–≤–µ—Ç, <span id="student-name">–°—Ç—É–¥–µ–Ω—Ç</span></div>
        <div class="muted small">
          ID: <span id="student-id">‚Äî</span>
          <span id="student-role" class="pill pill-supabase" style="display:none;"></span>
          <button id="profile-sync-btn" class="btn tiny ghost" style="display:none;">–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
        </div>
      </div>
      <div class="status-chips">
        <div class="chip status-chip status-idle" data-status-id="supabase"><span class="label">Supabase</span><span class="status-text">‚Äî</span></div>
        <div class="chip status-chip status-idle" data-status-id="jitsi"><span class="label">Jitsi</span><span class="status-text">–ì–æ—Ç–æ–≤</span></div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- üî• –ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–±—ã—Ç–∏–µ -->
    <section id="tab-next" class="tab active">
      <div class="card highlight">
        <div class="card-header">
          <div class="card-title">üöÄ –ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–±—ã—Ç–∏–µ</div>
          <div class="muted small">–ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é</div>
        </div>
        <div id="next-event-content">–î–æ–±–∞–≤—å—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤ Supabase.</div>
      </div>
    </section>

    <!-- üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
    <section id="tab-schedule" class="tab">
      <div class="card">
        <div class="card-title">üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>

        <div id="teacher-schedule-card" class="card subcard" style="display:none;">
          <div class="card-header" style="align-items:center;gap:8px;">
            <div class="card-title" style="margin:0;">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ —É—á–µ–Ω–∏–∫—É</div>
            <button class="btn ghost tiny" id="toggle-event-form">–°–≤–µ—Ä–Ω—É—Ç—å</button>
          </div>
          <div id="event-form-body" class="collapsible-body">
          <div class="grid-2 grid-1-sm">
            <input type="hidden" id="event-id">

            <label class="field">
              <span class="muted small">–£—á–µ–Ω–∏–∫ (–∏–º—è –∏–ª–∏ ID)</span>
              <input type="text" id="event-student-name" list="students-list" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∏–º—è –∏–ª–∏ ID" autocomplete="off">
              <datalist id="students-list"></datalist>
            </label>
            <label class="field">
              <span class="muted small">–ù–∞–π–¥–µ–Ω–Ω—ã–µ ID</span>
              <input type="text" id="event-student-ids" readonly placeholder="‚Äî">
            </label>
            <div class="helper span2">–ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é; —Å–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞—Å—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–µ–Ω–∏–∫–∞.</div>

            <label class="field">
              <span class="muted small">–ì—Ä—É–ø–ø–∞</span>
              <select id="event-group-select">
                <option value="">–ë–µ–∑ –≥—Ä—É–ø–ø—ã</option>
              </select>
              <label class="inline-check"><input type="checkbox" id="event-group-all"> <span>–°–æ–∑–¥–∞—Ç—å –¥–ª—è –≤—Å–µ—Ö –≤ –≥—Ä—É–ø–ø–µ</span></label>
            </label>
            <label class="field">
              <span class="muted small">–¢–µ–º–∞</span>
              <input type="text" id="event-subject" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞">
            </label>

            <label class="field">
              <span class="muted small">–î–∞—Ç–∞</span>
              <input type="date" id="event-date">
            </label>
            <label class="field">
              <span class="muted small">–í—Ä–µ–º—è</span>
              <input type="time" id="event-time">
            </label>

            <label class="field">
              <span class="muted small">–ü–æ–≤—Ç–æ—Ä—è—Ç—å –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é (–∫–æ–ª-–≤–æ –¥–æ–ø. –Ω–µ–¥–µ–ª—å)</span>
              <input type="number" min="0" max="20" id="event-repeat" value="0">
            </label>
            <label class="field">
              <span class="muted small">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –º–∏–Ω</span>
              <input type="number" min="10" max="300" id="event-duration" value="60">
            </label>

            <label class="field">
              <span class="muted small">–°—Ç–∞—Ç—É—Å</span>
              <select id="event-status">
                <option value="planned">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ</option>
                <option value="done">–ü—Ä–æ–≤–µ–¥–µ–Ω–æ</option>
                <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–æ</option>
              </select>
            </label>

            <label class="field" style="grid-column:1/2;">
              <span class="muted small">–ì—Ä—É–ø–ø–∞/–∫–ª–∞—Å—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
              <input type="text" id="event-group" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 7–ê –∏–ª–∏ –ì—Ä—É–ø–ø–∞ 3">
            </label>
            <label class="field" style="grid-column:1/3;">
              <span class="muted small">–°—Å—ã–ª–∫–∞ –Ω–∞ –≤—Å—Ç—Ä–µ—á—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
              <input type="url" id="event-link" placeholder="https://meet...">
            </label>
          </div>
          <div class="button-row">
            <button class="btn full" id="event-submit-btn">–°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ</button>
            <button class="btn ghost full" id="event-delete-btn" style="display:none;">–£–¥–∞–ª–∏—Ç—å</button>
          </div>
          </div>

          <div class="card subcard" id="directory-card">
            <div class="card-header" style="align-items:center;gap:8px;">
              <div class="card-title" style="margin:0;">–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫: –≥—Ä—É–ø–ø—ã –∏ —É—á–µ–Ω–∏–∫–∏</div>
              <button class="btn ghost tiny" id="toggle-directory">–°–≤–µ—Ä–Ω—É—Ç—å</button>
            </div>
            <div id="directory-body" class="collapsible-body">
            <div class="grid-2">
              <label class="field">
                <span class="muted small">–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã</span>
                <input type="text" id="group-name-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì—Ä—É–ø–ø–∞ 1">
              </label>
              <div class="button-row">
                <button class="btn ghost full" id="group-create-btn">–°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –≥—Ä—É–ø–ø—É</button>
              </div>
              <label class="field">
                <span class="muted small">–ò–º—è —É—á–µ–Ω–∏–∫–∞</span>
                <input type="text" id="student-name-input" placeholder="–ò–º—è —É—á–µ–Ω–∏–∫–∞">
              </label>
              <label class="field">
                <span class="muted small">Telegram ID —É—á–µ–Ω–∏–∫–∞</span>
                <input type="number" id="student-id-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 123456789">
              </label>
              <label class="field">
                <span class="muted small">–ì—Ä—É–ø–ø–∞ —É—á–µ–Ω–∏–∫–∞</span>
                <select id="student-group-select"><option value="">–ë–µ–∑ –≥—Ä—É–ø–ø—ã</option></select>
              </label>
              <div class="button-row">
                <button class="btn ghost full" id="student-create-btn">–°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å —É—á–µ–Ω–∏–∫–∞</button>
              </div>
            </div>
            </div>
          </div>
        </div>

        <div id="calendar"></div>

        <div class="card" style="margin-top:1rem;">
          <div class="card-title">–°–æ–±—ã—Ç–∏—è –Ω–∞ –¥–∞—Ç—É</div>
          <ul id="event-list"><li>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</li></ul>
        </div>
      </div>
    </section>

    <!-- üìù –î–æ–º–∞—à–∫–∞ -->
    <section id="tab-homework" class="tab">
      <div class="card">
        <div class="card-title">üìù –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</div>
        <label class="field">
          <span class="muted small">–§–∞–π–ª</span>
          <input type="file" id="hw-file">
        </label>
        <button id="hw-upload-btn" class="btn full">–ó–∞–≥—Ä—É–∑–∏—Ç—å –î–ó</button>
        <div id="hw-status" class="muted" style="margin-top:.5rem;"></div>

        <h3 class="section-subtitle">–ú–æ–∏ —Ñ–∞–π–ª—ã</h3>
        <div id="hw-list">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
      </div>
    </section>

    <!-- üé• –í–∏–¥–µ–æ -->
    <section id="tab-video" class="tab">
      <div class="card">
        <div class="card-title">üé• –í–∏–¥–µ–æ–º–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
        <div class="field">
          <span class="muted small">–§–∞–π–ª</span>
          <input type="file" id="video-file" accept="video/*">
        </div>
        <div class="field">
          <span class="muted small">–ù–∞–∑–≤–∞–Ω–∏–µ</span>
          <input type="text" id="video-title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –õ–µ–∫—Ü–∏—è 3">
        </div>
        <button id="video-upload-btn" class="btn full">–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ</button>
        <div id="video-status" class="muted" style="margin-top:.5rem;"></div>

        <h3 class="section-subtitle">–°–ø–∏—Å–æ–∫ –≤–∏–¥–µ–æ</h3>
        <div id="video-list">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
      </div>
    </section>

    <!-- ü¶ö Jitsi -->
    <section id="tab-jitsi" class="tab">
      <div class="card">
        <div class="card-title">üíª –í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ Jitsi</div>
        <div id="jitsi-container" style="height:340px;"></div>
        <div class="button-row">
          <button class="btn" onclick="window.jitsiApi?.executeCommand('toggleAudio')">üéô</button>
          <button class="btn" onclick="window.jitsiApi?.executeCommand('toggleVideo')">üì∑</button>
          <button class="btn" onclick="window.jitsiApi?.executeCommand('toggleChat')">üí¨</button>
          <button class="btn" onclick="window.jitsiApi?.executeCommand('toggleShareScreen')">üñ•</button>
          <button class="btn" id="jitsi-participants-btn">üë•</button>
        </div>
      </div>
    </section>
  </main>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
  <nav class="tab-bar">
    <button id="btn-next" class="active"><span class="icon">üî•</span><span class="label">–°–æ–±—ã—Ç–∏–µ</span></button>
    <button id="btn-schedule"><span class="icon">üìÖ</span><span class="label">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span></button>
    <button id="btn-homework"><span class="icon">üìù</span><span class="label">–î–æ–º–∞—à–∫–∞</span></button>
    <button id="btn-video"><span class="icon">üé•</span><span class="label">–í–∏–¥–µ–æ</span></button>
    <button id="btn-jitsi"><span class="icon">ü¶ö</span><span class="label">Jitsi</span></button>
  </nav>

  <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ø–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω) -->
  <script type="module" src="js/utils/date.js"></script>
  <script type="module" src="js/utils/dom.js"></script>

  <script type="module" src="js/config.js"></script>

  <script type="module" src="js/services/supabase.js"></script>
  <script type="module" src="js/services/googleCalendar.js"></script>
  <script type="module" src="js/services/meetings.js"></script>

  <script type="module" src="js/ui/tabs.js"></script>
  <script type="module" src="js/ui/nextEventCard.js"></script>
  <script type="module" src="js/ui/calendarView.js"></script>
  <script type="module" src="js/ui/homeworkView.js"></script>
  <script type="module" src="js/ui/videoView.js"></script>
  <script type="module" src="js/ui/jitsiView.js"></script>
  <script type="module" src="js/ui/toast.js"></script>
  <script type="module" src="js/ui/status.js"></script>

  <script type="module" src="js/main.js?v=2025-08-24"></script>

  <div id="toast-container"></div>

  <div id="access-gate" style="display:none;">
    <div class="gate-card">
      <div class="gate-brand">MENTORIUM</div>
      <div class="gate-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</div>
      <div class="gate-text">
        <p>–ù–∞–∂–º–∏—Ç–µ ‚Äú–ü–µ—Ä–µ–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ‚Äù, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–∞—à ID –∏ –∏–º—è. –î–æ—Å—Ç—É–ø –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–æ—Å–ª–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.</p>
        <p id="access-msg" class="muted small"></p>
      </div>
      <button id="access-btn" class="btn full">–ü–µ—Ä–µ–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
    </div>
  </div>
</body>
</html>
